@page "/"
@using ShowMeTheBet.Models
@using ShowMeTheBet.Services
@inject BettingService BettingService
@inject AuthService AuthService
@inject NavigationManager Navigation
@rendermode InteractiveServer

<PageTitle>ShowMeTheBet</PageTitle>

@if (!AuthService.IsAuthenticated)
{
    <div class="auth-required">
        <div class="auth-message">
            <h2>ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h2>
            <p>ë² íŒ…ì„ í•˜ë ¤ë©´ ë¨¼ì € ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.</p>
            <button class="btn btn-primary" @onclick="NavigateToLogin">ë¡œê·¸ì¸í•˜ê¸°</button>
        </div>
    </div>
}
else
{
    <div class="main-container">
        <div class="main-header">
            <h1>âš½ ShowMeTheBet</h1>
            <div class="balance-display">
                <span class="balance-label">ì”ì•¡:</span>
                <span class="balance-amount">@balance.ToString("N0") ì›</span>
            </div>
        </div>

        <div class="games-menu">
            <h2>ê²Œì„ ì„ íƒ</h2>
            <div class="games-grid">
                <div class="game-card" @onclick="NavigateToSports">
                    <div class="game-icon">âš½</div>
                    <h3>ìŠ¤í¬ì¸  í† í† </h3>
                    <p>ì‹¤ì‹œê°„ ê²½ê¸° ë² íŒ…</p>
                    <div class="game-badge">ìŠ¤í¬ì¸ </div>
                </div>

                <div class="game-card" @onclick="NavigateToOddEven">
                    <div class="game-icon">ğŸ²</div>
                    <h3>í™€ì§</h3>
                    <p>30ì´ˆë§ˆë‹¤ ê²°ê³¼ ë°œí‘œ</p>
                    <div class="game-badge">x2.0</div>
                </div>

                <div class="game-card" @onclick="NavigateToGraph">
                    <div class="game-icon">ğŸ“ˆ</div>
                    <h3>ê·¸ë˜í”„</h3>
                    <p>ë°°ìˆ˜ ê²Œì„ (x1 ~ x5)</p>
                    <div class="game-badge">ë°°ìˆ˜</div>
                </div>
            </div>
        </div>
    </div>
}

@code {
    private decimal balance = 0;

    protected override async Task OnInitializedAsync()
    {
        if (AuthService.IsAuthenticated)
        {
            balance = await BettingService.GetBalanceAsync();
        }
    }

    private void NavigateToLogin()
    {
        Navigation.NavigateTo("/login");
    }

    private void NavigateToSports()
    {
        Navigation.NavigateTo("/sports");
    }

    private void NavigateToOddEven()
    {
        Navigation.NavigateTo("/oddeven");
    }

    private void NavigateToGraph()
    {
        Navigation.NavigateTo("/graph");
    }
}
